pipeline {
   def tomcatWeb = '/opt/tomcat/webapps'
   def tomcatBin = '/opt/tomcat/bin'
   def tomcatStatus = ''
   agent any
   tools {
      maven 'maven'
      jdk 'jdk'
    }
    stages {
      stage('Build') {
        steps {
          echo 'Building...'
          echo "Running ${env.BUILD_ID} ${env.BUILD_DISPLAY_NAME} on ${env.NODE_NAME} and JOB ${env.JOB_NAME}"
          sh 'mvn -f ./maven-project/pom.xml clean compile' 
        }
   }
   stage('Test') {
     steps {
        echo 'Testing...'
     }
   }
   stage('Deploy') {
     steps {
        bat 'copy target/webapp.war ${tomcatWeb}/webapp.war'
       }
        	   
   }
   stage ('Start Tomcat Server') {
         sleep(time:5,unit:"SECONDS") 
         bat "${tomcatBin}/startup.bat"
         sleep(time:100,unit:"SECONDS")
   }
        
  }
}
}
